# Part A

The objectives for Part A are:

- Serving a static page with CloudFront (CDN)
- Using Terraform to achieve Infrastructure as Code

*If you don't know what Content Distribustion Networks (CDNs) and Infrastructure as Code are or why they are significant, it's recommended that you read up on it. We will not cover those topics here.*

## Setup

1. Install the latest version of Terraform [here](https://www.terraform.io/downloads.html)
2. Install `awscli` if you haven't: `pip install awscli`
3. Install `create-react-app` if you haven't: `npm install -g create-react-app`

## A Bit about Terraform

**Before you read further...** *Terraform itself is simple, but operating it has its own learning curve. Practice makes perfect.*

Terraform is at its core a powerful declarative templating tool that statefully interacts with API resources. What does this mean? Because any resource that is controllable via HTTP APIs is done so by CRUD-ing it with configuration files, Terraform can template those configuration files in reusable modules with variable inputs and outputs. 

> For example, while requesting an EC2 instance on AWS, operating system (AMI) might be an input you configure and the instance id generated by AWS might be an output. The AWS Provider for Terraform exposes pretty much all AWS resources to Terraform.

In Terraform, you can take those outputs and feed them as inputs to other resources. These resource components may further be composed into a custom reusable modules for your usecase with your own inputs and outputs. 

> For example, if you always pair your instance group (ASG) with a load balancer (ELB) in a specific way, you can wrap them into a single module.

Once your configuration files are semiprogramatically generated, Terraform will then CRUD them by checking them against its knowledge of what exists in what state. It is able to synchronize the remote resources with the desired state you've described with your Terraform files.

## Getting started with Terraform

### Wiring

Check out the `starter/frontend.tf` file. You can see how these configuration blocks are connected to each other with outputs. `aws_s3_bucket.imagely_frontend.id` is the `id` output of `aws_s3_bucket.imagely_frontend`. See [docs](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/s3_bucket#attribute-reference) for a reference of all of the outputs of `aws_s3_bucket`. All resources have their inputs and outputs documented.

### Templating

In the bucket policy block you can see an example of templating. `"${aws_s3_bucket.imagely_frontend.arn}/*"` will substitute `${...}` with the arn of the resource. The templating engine in Terraform has functions that enable manipulation that can sometimes even be too powerful [docs](https://www.terraform.io/docs/configuration/syntax.html).

### Deploying

Once you modify the starter code, you can deploy it:

`terraform init` if you haven't already.
`terraform plan` to preview what Terraform will do
`teraform apply` to deploy

That's it! So much better than clicking around in the UI isn't it?

## Instructions

1. Create a CloudFront distribution that serves from this bucket. This is one of the most frustrating AWS resources to learn on because of complex configurations and how long it takes to update. There are plenty of examples out there, but you will quickly run into a wall if you don't know how to configure it using the AWS dashboard.
2. There's a basic CRA webapp in `starter/frontend`. Build the frontend and push the contents of `starter/frontend/build` to the bucket. There's a helper script in `scripts/publish.sh` to help you streamline this step. Make sure to change the bucket name.
3. Ask for help! Some things are not worth your time digging on stackexchange for.

**Note** If you plan on using your own domain name with your own cert (costs money) feel free to do so, but let me know because it affects later steps.